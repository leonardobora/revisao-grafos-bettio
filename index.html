<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estudo de Grafos - Flashcards & Exerc√≠cios</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      /* Modern Color Palette */
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-warning: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      
      --color-primary: #667eea;
      --color-primary-dark: #5568d3;
      --color-secondary: #764ba2;
      --color-success: #00d4aa;
      --color-warning: #ffd93d;
      --color-danger: #ff6b9d;
      
      --color-bg: #f8f9ff;
      --color-surface: #ffffff;
      --color-text: #2d3748;
      --color-text-light: #718096;
      --color-border: #e2e8f0;
      
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.06);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.06);
      --shadow-lg: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
      --shadow-xl: 0 20px 25px rgba(0,0,0,0.15), 0 10px 10px rgba(0,0,0,0.04);
      
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
      padding-top: 80px;
      min-height: 100vh;
    }

    /* Header Moderno e Fixo */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--gradient-primary);
      padding: 1rem 2rem;
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .header-title {
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .header-title::before {
      content: "üìö";
      font-size: 1.8rem;
    }

    .header-nav {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .social-links {
      display: flex;
      gap: 0.75rem;
      margin-right: 1rem;
      padding-right: 1rem;
      border-right: 1px solid rgba(255,255,255,0.3);
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255,255,255,0.2);
      border-radius: 50%;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .social-link:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }

    .social-link svg {
      width: 20px;
      height: 20px;
      fill: white;
    }

    .nav-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: var(--radius-md);
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .nav-btn:hover, .nav-btn.active {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* Container Principal */
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 2rem;
    }

    .screen {
      display: none;
      animation: fadeIn 0.4s ease;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Tela Inicial */
    .hero {
      text-align: center;
      padding: 3rem 0;
    }

    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-subtitle {
      font-size: 1.2rem;
      color: var(--color-text-light);
      margin-bottom: 3rem;
    }

    .btn-group {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-main {
      background: var(--gradient-primary);
      color: white;
      border: none;
      padding: 1.2rem 2.5rem;
      border-radius: var(--radius-lg);
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
    }

    .btn-main::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .btn-main:hover::before {
      left: 100%;
    }

    .btn-main:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-xl);
    }

    /* Se√ß√µes */
    .section-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .section-header h2 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--color-primary);
    }

    /* Filtros Modernos */
    .filtros {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      justify-content: center;
      background: var(--color-surface);
      padding: 1.5rem;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
    }

    .filtros select, .filtros input {
      padding: 0.75rem 1rem;
      border: 2px solid var(--color-border);
      border-radius: var(--radius-md);
      font-size: 1rem;
      background: white;
      transition: all 0.3s ease;
      min-width: 180px;
    }

    .filtros select:focus, .filtros input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .filtros button {
      background: var(--gradient-success);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filtros button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* Flashcard 3D Moderno - CORRIGIDO */
    .flashcard {
      background: var(--color-surface);
      border-radius: var(--radius-xl);
      padding: 3rem;
      margin: 2rem auto;
      max-width: 600px;
      min-height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: var(--shadow-lg);
      border: 3px solid transparent;
      background-clip: padding-box;
      position: relative;
    }

    .flashcard::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      background: var(--gradient-primary);
      border-radius: var(--radius-xl);
      z-index: -1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .flashcard:hover::before {
      opacity: 1;
    }

    .flashcard:hover {
      transform: scale(1.02);
      box-shadow: var(--shadow-xl);
    }

    .flashcard.flipped {
      background: var(--gradient-success);
      color: white;
      /* Removido transform: rotateY(180deg) para evitar texto invertido */
      transform: scale(1.05);
    }

    .card-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .card-actions button {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: var(--radius-md);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .btn-dominei {
      background: var(--gradient-success);
      color: white;
    }

    .btn-rever {
      background: var(--gradient-warning);
      color: var(--color-text);
    }

    .btn-dica {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      color: var(--color-text);
    }

    .card-actions button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }

    /* Exerc√≠cios */
    .exercicio-card {
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      padding: 2rem;
      margin: 1.5rem 0;
      box-shadow: var(--shadow-md);
      transition: all 0.3s ease;
      border-left: 4px solid var(--color-primary);
    }

    .exercicio-card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateX(4px);
    }

    .exercicio-titulo {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--color-primary);
      margin-bottom: 1rem;
    }

    .exercicio-enunciado {
      white-space: pre-line;
      margin-bottom: 1.5rem;
      line-height: 1.8;
      color: var(--color-text);
    }

    .exercicio-diagrama {
      background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%);
      border-radius: var(--radius-md);
      padding: 2rem;
      margin: 1.5rem 0;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 2px solid var(--color-border);
      box-shadow: var(--shadow-sm);
      min-height: 300px;
    }

    .exercicio-diagrama svg {
      max-width: 100%;
      height: auto;
    }

    .graph-node {
      fill: white;
      stroke: var(--color-primary);
      stroke-width: 3;
      filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
    }

    .graph-node:hover {
      fill: #f0f4ff;
    }

    .graph-edge {
      stroke: var(--color-primary);
      stroke-width: 2;
      fill: none;
    }

    .graph-edge-double {
      stroke: var(--color-primary);
      stroke-width: 2;
      fill: none;
      stroke-dasharray: none;
    }

    .graph-edge-label {
      fill: var(--color-text);
      font-size: 14px;
      font-weight: 600;
    }

    .graph-label {
      fill: var(--color-text);
      font-size: 18px;
      font-weight: 700;
      text-anchor: middle;
      dominant-baseline: central;
    }

    .graph-subgraph-title {
      fill: var(--color-primary);
      font-size: 14px;
      font-weight: 600;
      text-anchor: middle;
    }

    .graph-subgraph-bg {
      fill: rgba(102, 126, 234, 0.05);
      stroke: var(--color-primary);
      stroke-width: 1;
      stroke-dasharray: 5,5;
      rx: 8;
    }

    .exercicio-entrada {
      width: 100%;
      min-height: 120px;
      padding: 1rem;
      border: 2px solid var(--color-border);
      border-radius: var(--radius-md);
      font-size: 1rem;
      font-family: inherit;
      transition: all 0.3s ease;
      resize: vertical;
    }

    .exercicio-entrada:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .exercicio-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .exercicio-solucao {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--color-success);
      white-space: pre-line;
    }

    /* Estat√≠sticas */
    .estatisticas-block {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: var(--radius-xl);
      padding: 2.5rem;
      margin: 2rem auto;
      max-width: 700px;
      box-shadow: var(--shadow-xl);
    }

    .estat-item {
      margin-bottom: 1.2rem;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }

    .estat-item:last-child {
      border-bottom: none;
    }

    .estat-item b {
      font-size: 1.3rem;
    }

    .recomendacao {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      padding: 1rem 1.5rem;
      border-radius: var(--radius-md);
      margin-top: 1.5rem;
      font-weight: 600;
      border-left: 4px solid white;
    }

    .duvida-registro {
      margin: 1.5rem auto;
      padding: 1rem 1.5rem;
      border-radius: var(--radius-md);
      background: var(--gradient-warning);
      color: var(--color-text);
      font-weight: 600;
      max-width: 500px;
      text-align: center;
      box-shadow: var(--shadow-md);
    }

    .flashcard-counter {
      text-align: center;
      margin-top: 1.5rem;
      color: var(--color-text-light);
      font-size: 1rem;
      font-weight: 600;
    }

    /* Responsivo */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        text-align: center;
      }

      .social-links {
        border-right: none;
        margin-right: 0;
        padding-right: 0;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .btn-group {
        flex-direction: column;
      }

      .filtros {
        flex-direction: column;
      }

      .filtros select, .filtros input {
        width: 100%;
        min-width: auto;
      }

      .flashcard {
        padding: 2rem;
        font-size: 1.1rem;
      }

      .card-actions {
        flex-direction: column;
      }

      .card-actions button {
        width: 100%;
      }
    }

    @media print {
      .header, .filtros, .card-actions, .exercicio-actions, .nav-btn {
        display: none !important;
      }
      body {
        background: white;
        padding-top: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Header Moderno com Links Sociais -->
  <header class="header">
    <div class="header-content">
      <div class="header-title">Revis√£o de Grafos</div>
      <div class="header-nav">
        <div class="social-links">
          <a href="https://linkedin.com/in/leonardobora" target="_blank" class="social-link" title="LinkedIn">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
            </svg>
          </a>
          <a href="https://github.com/leonardobora" target="_blank" class="social-link" title="GitHub">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
          </a>
        </div>
        <button class="nav-btn" id="nav-flashcards">Flashcards</button>
        <button class="nav-btn" id="nav-exercicios">Exerc√≠cios</button>
        <button class="nav-btn" id="nav-estatisticas">Estat√≠sticas</button>
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Tela Inicial -->
    <div id="screen-inicio" class="screen active">
      <div class="hero">
        <h1>Sistema de Estudos de Grafos</h1>
        <p class="hero-subtitle">Domine Teoria dos Grafos com flashcards interativos e exerc√≠cios pr√°ticos</p>
        <div class="btn-group">
          <button class="btn-main" id="btn-iniciar-flashcards">üìö Revisar Flashcards</button>
          <button class="btn-main" id="btn-iniciar-exercicios">‚úçÔ∏è Fazer Exerc√≠cios</button>
        </div>
      </div>
    </div>

    <!-- Tela Flashcards -->
    <div id="screen-flashcards" class="screen">
      <div class="section-header">
        <h2>Revis√£o de Flashcards</h2>
      </div>
      <div class="filtros">
        <select id="filtro-categoria">
          <option value="">Todas categorias</option>
        </select>
        <select id="filtro-dificuldade">
          <option value="">Todas dificuldades</option>
          <option value="B√°sico">B√°sico</option>
          <option value="Intermedi√°rio">Intermedi√°rio</option>
          <option value="Avan√ßado">Avan√ßado</option>
        </select>
        <input type="text" id="filtro-tema" placeholder="üîç Filtrar por tema..." />
        <button id="btn-embaralhar-cards">üîÄ Embaralhar</button>
      </div>
      <div id="flashcard-container"></div>
    </div>

    <!-- Tela Exerc√≠cios -->
    <div id="screen-exercicios" class="screen">
      <div class="section-header">
        <h2>Simulado de Exerc√≠cios</h2>
      </div>
      <div class="filtros">
        <select id="filtro-nivel">
          <option value="">Todas dificuldades</option>
          <option value="B√°sico">B√°sico</option>
          <option value="Intermedi√°rio">Intermedi√°rio</option>
          <option value="Avan√ßado">Avan√ßado</option>
        </select>
      </div>
      <div id="exercicios-lista"></div>
    </div>

    <!-- Tela Estat√≠sticas -->
    <div id="screen-estatisticas" class="screen">
      <div class="section-header">
        <h2>Estat√≠sticas de Estudo</h2>
      </div>
      <div class="estatisticas-block" id="estatisticas-container"></div>
    </div>
  </div>

  <script>
    // Custom Graph Rendering Library
    class GraphRenderer {
      constructor() {
        this.nodeRadius = 30;
        this.nodeSpacing = 120;
      }

      renderGraph(container, graphDef) {
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('width', '100%');
        svg.setAttribute('viewBox', '0 0 600 400');
        svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');

        // Parse graph definition and render
        this.parseAndRender(svg, graphDef);

        container.innerHTML = '';
        container.appendChild(svg);
      }

      parseAndRender(svg, graphDef) {
        const { nodes, edges, layout } = graphDef;
        
        // Render edges first (so they appear behind nodes)
        edges.forEach(edge => {
          const from = nodes.find(n => n.id === edge.from);
          const to = nodes.find(n => n.id === edge.to);
          
          if (edge.type === 'double') {
            // Render two parallel lines for double edges
            this.drawDoubleLine(svg, from.x, from.y, to.x, to.y, edge.label);
          } else if (edge.type === 'loop') {
            this.drawLoop(svg, from.x, from.y, edge.label);
          } else {
            this.drawLine(svg, from.x, from.y, to.x, to.y, edge.label);
          }
        });

        // Render nodes
        nodes.forEach(node => {
          this.drawNode(svg, node.x, node.y, node.label, node.highlight);
        });
      }

      drawNode(svg, x, y, label, highlight = false) {
        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('cx', x);
        circle.setAttribute('cy', y);
        circle.setAttribute('r', this.nodeRadius);
        circle.setAttribute('class', 'graph-node');
        if (highlight) {
          circle.setAttribute('fill', '#fff4e6');
        }
        svg.appendChild(circle);

        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', x);
        text.setAttribute('y', y);
        text.setAttribute('class', 'graph-label');
        text.textContent = label;
        svg.appendChild(text);
      }

      drawLine(svg, x1, y1, x2, y2, label = '') {
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', x1);
        line.setAttribute('y1', y1);
        line.setAttribute('x2', x2);
        line.setAttribute('y2', y2);
        line.setAttribute('class', 'graph-edge');
        svg.appendChild(line);

        if (label) {
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', (x1 + x2) / 2);
          text.setAttribute('y', (y1 + y2) / 2 - 5);
          text.setAttribute('class', 'graph-edge-label');
          text.textContent = label;
          svg.appendChild(text);
        }
      }

      drawDoubleLine(svg, x1, y1, x2, y2, label = '') {
        const offset = 5;
        const dx = x2 - x1;
        const dy = y2 - y1;
        const len = Math.sqrt(dx * dx + dy * dy);
        const perpX = -dy / len * offset;
        const perpY = dx / len * offset;

        this.drawLine(svg, x1 + perpX, y1 + perpY, x2 + perpX, y2 + perpY);
        this.drawLine(svg, x1 - perpX, y1 - perpY, x2 - perpX, y2 - perpY);

        if (label) {
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', (x1 + x2) / 2);
          text.setAttribute('y', (y1 + y2) / 2 - 10);
          text.setAttribute('class', 'graph-edge-label');
          text.textContent = label;
          svg.appendChild(text);
        }
      }

      drawLoop(svg, x, y, label = '') {
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        const r = this.nodeRadius;
        const d = `M ${x} ${y - r} Q ${x + r * 1.5} ${y - r * 2}, ${x + r * 0.7} ${y - r * 0.7}`;
        path.setAttribute('d', d);
        path.setAttribute('class', 'graph-edge');
        path.setAttribute('fill', 'none');
        svg.appendChild(path);

        if (label) {
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', x + r * 1.2);
          text.setAttribute('y', y - r * 1.5);
          text.setAttribute('class', 'graph-edge-label');
          text.textContent = label;
          svg.appendChild(text);
        }
      }
    }

    window.GraphRenderer = GraphRenderer;

    // Dados em mem√≥ria
    const flashcards = [
      {id:1,categoria:"Conceitos B√°sicos",frente:"O que √© um Grafo?",verso:"Um grafo G(V,E) √© uma estrutura composta por:\n- V: conjunto n√£o vazio de v√©rtices (ou n√≥s)\n- E: subconjunto de pares n√£o ordenados de V (arestas)",dica:"Lembre-se: G(V,E) = V√©rtices + Arestas"},
      {id:2,categoria:"Conceitos B√°sicos",frente:"O que √© a Ordem de um Grafo?",verso:"√â o n√∫mero de v√©rtices do grafo.\nS√≠mbolo: |V|",dica:"Ordem = quantidade de v√©rtices"},
      {id:3,categoria:"Conceitos B√°sicos",frente:"O que √© Adjac√™ncia em Grafos?",verso:"Duas arestas s√£o adjacentes se incidem sobre o mesmo v√©rtice.\nExemplo: (Ana, Maria) e (Ana, Jos√©) s√£o adjacentes pois compartilham o v√©rtice Ana",dica:"Adjacente = compartilha v√©rtice"},
      {id:4,categoria:"Graus de V√©rtices",frente:"O que √© Grau de um V√©rtice?",verso:"√â o n√∫mero de arestas incidentes no v√©rtice.\nOBS: Um la√ßo conta como grau 2!",dica:"Conte as arestas que tocam o v√©rtice"},
      {id:5,categoria:"Graus de V√©rtices",frente:"Diferen√ßa entre Grau de Entrada e Grau de Sa√≠da",verso:"- Grau de Entrada (indegree): n√∫mero de arestas que ENTRAM em um n√≥\n- Grau de Sa√≠da (outdegree): n√∫mero de arestas que SAEM de um n√≥\nAplica-se a grafos ORIENTADOS",dica:"In = entra, Out = sai"},
      {id:6,categoria:"Graus de V√©rtices",frente:"O que √© um V√©rtice Isolado?",verso:"√â um v√©rtice com grau = 0 (n√£o tem arestas conectadas a ele)",dica:"Isolado = sozinho = grau 0"},
      {id:7,categoria:"Graus de V√©rtices",frente:"O que √© um V√©rtice Pendente?",verso:"√â um v√©rtice com Gr(V) = 1 (apenas uma aresta conectada)",dica:"Pendente = pendurado por 1 aresta"},
      {id:8,categoria:"Tipos de Arestas",frente:"O que √© um La√ßo?",verso:"√â uma aresta que sai e entra no mesmo n√≥.\nIMPORTANTE: La√ßo sempre tem grau = 2",dica:"La√ßo = loop no mesmo v√©rtice"},
      {id:9,categoria:"Tipos de Arestas",frente:"O que s√£o Arestas Paralelas?",verso:"S√£o duas ou mais arestas que conectam os mesmos dois v√©rtices",dica:"Paralelas = mesmo caminho repetido"},
      {id:10,categoria:"Tipos de Arestas",frente:"O que √© uma Ponte?",verso:"√â uma aresta que, ao ser removida, torna o grafo DESCONEXO",dica:"Ponte = se tirar, desconecta"},
      {id:11,categoria:"Classifica√ß√£o de Grafos",frente:"Diferen√ßa entre Grafo Conexo e Desconexo",verso:"- CONEXO: existe pelo menos um caminho entre cada par de v√©rtices\n- DESCONEXO: existe pelo menos um par de v√©rtices sem caminho entre eles",dica:"Conexo = todo mundo conectado"},
      {id:12,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Multigrafo?",verso:"√â um grafo que possui la√ßos E/OU arestas paralelas",dica:"Multi = tem repeti√ß√£o"},
      {id:13,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Grafo Simples?",verso:"√â um grafo que N√ÉO possui la√ßos nem arestas paralelas",dica:"Simples = sem repeti√ß√µes"},
      {id:14,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Grafo Completo?",verso:"√â um grafo simples onde TODO v√©rtice √© adjacente a TODOS os outros v√©rtices.\nNota√ß√£o: Kn (onde n √© o n√∫mero de v√©rtices)",dica:"Completo = todos conectados com todos"},
      {id:15,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Subgrafo?",verso:"√â um grafo formado a partir de um subconjunto dos v√©rtices e arestas de um grafo original",dica:"Sub = parte de um grafo maior"},
      {id:16,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Grafo Complementar?",verso:"O complemento de G √© um grafo H com os MESMOS v√©rtices, onde dois v√©rtices s√£o adjacentes em H SE E SOMENTE SE n√£o s√£o adjacentes em G.\nRegra: preenche arestas faltantes para grafo completo e remove as existentes",dica:"Complemento = inverte as arestas"},
      {id:17,categoria:"Classifica√ß√£o de Grafos",frente:"O que √© um Grafo Bipartido?",verso:"√â um grafo cujos v√©rtices podem ser divididos em dois conjuntos U e V, onde toda aresta conecta um v√©rtice de U a um v√©rtice de V (nunca dois do mesmo conjunto)",dica:"Bi = dois grupos separados"},
      {id:18,categoria:"Classifica√ß√£o de Grafos",frente:"Diferen√ßa entre Grafo Rotulado e Valorado",verso:"- ROTULADO: cada v√©rtice tem um r√≥tulo/nome\n- VALORADO (ou ponderado): as arestas possuem valores/pesos num√©ricos",dica:"Rotulado = nomes, Valorado = n√∫meros nas arestas"},
      {id:19,categoria:"Caminhos",frente:"O que √© um Caminho?",verso:"√â uma sequ√™ncia de arestas onde o v√©rtice final de uma aresta √© o v√©rtice inicial da pr√≥xima",dica:"Caminho = seguir arestas conectadas"},
      {id:20,categoria:"Caminhos",frente:"Teorema das √Årvores (3 propriedades)",verso:"Seja T uma √°rvore com n v√©rtices:\nI. T √© conexo e sem ciclos\nII. T √© conexo e possui (n-1) arestas\nIII. Cada aresta √© uma ponte",dica:"√Årvore: conexo + n-1 arestas + sem ciclos"},
      {id:21,categoria:"Euleriano vs Hamiltoniano",frente:"O que √© um Caminho Euleriano? (MACETE)",verso:"**Euleriano + Aresta** (vogais A e E)\nCaminho que visita cada ARESTA apenas uma vez\n\nCircuito Euleriano: come√ßa e termina no mesmo v√©rtice",dica:"EULERIANO = ARESTA (vogais)"},
      {id:22,categoria:"Euleriano vs Hamiltoniano",frente:"O que √© um Caminho Hamiltoniano? (MACETE)",verso:"**Hamiltoniano + V√©rtices** (consoantes H e V)\nCaminho que passa por todos os V√âRTICES uma √∫nica vez\n\nCiclo Hamiltoniano: caminho hamiltoniano fechado",dica:"HAMILTONIANO = V√âRTICES (consoantes)"},
      {id:23,categoria:"Representa√ß√µes",frente:"O que √© Lista de Adjac√™ncia?",verso:"Estrutura de dados onde cada v√©rtice tem uma lista com seus v√©rtices adjacentes (vizinhos)",dica:"Lista = cada v√©rtice tem sua lista de vizinhos"},
      {id:24,categoria:"Representa√ß√µes",frente:"O que √© Matriz de Adjac√™ncia?",verso:"Matriz n√ón onde:\n- Posi√ß√£o [i][j] = 1 se existe aresta entre i e j\n- Posi√ß√£o [i][j] = 0 se n√£o existe aresta\nPara grafos ponderados: [i][j] = peso da aresta",dica:"Matriz: 1 = conectado, 0 = n√£o conectado"},
      {id:25,categoria:"Representa√ß√µes",frente:"O que √© Matriz de Incid√™ncia?",verso:"Matriz n√óm (v√©rtices √ó arestas) onde:\n- Elemento [v][e] representa quantas vezes (0, 1 ou 2) o v√©rtice v e a aresta e s√£o incidentes",dica:"Incid√™ncia: v√©rtices vs arestas"},
      {id:26,categoria:"Isomorfismo",frente:"O que s√£o Grafos Isomorfos?",verso:"Dois grafos G1(V1,E1) e G2(V2,E2) s√£o isomorfos se:\n- |V1| = |V2|\n- Existe fun√ß√£o f: V1‚ÜíV2 que preserva adjac√™ncias\n- (i,j) ‚àà E1 ‚ü∫ (f(i),f(j)) ‚àà E2\n\nEm outras palavras: mesma estrutura, mas v√©rtices podem ter nomes diferentes",dica:"Isomorfo = mesma forma, nomes diferentes"}
    ];
    
    const exercicios = [
      {
        numero: 1, nivel: 'B√°sico', titulo: 'Identifica√ß√£o de Elementos',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 100, y: 100 },
            { id: 'B', label: 'B', x: 300, y: 100 },
            { id: 'C', label: 'C', x: 100, y: 250 },
            { id: 'D', label: 'D', x: 300, y: 250 },
            { id: 'E', label: 'E', x: 500, y: 250 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'A', to: 'C' },
            { from: 'B', to: 'D' },
            { from: 'C', to: 'D' },
            { from: 'D', to: 'E' }
          ]
        },
        enunciado: 'Dado o grafo ao lado:\n\na) Qual √© a ordem do grafo?\nb) Liste todos os pares de v√©rtices adjacentes\nc) Calcule o grau de cada v√©rtice\nd) O grafo √© conexo? Por qu√™?',
        resposta: 'a) Ordem = 5 v√©rtices (A, B, C, D, E)\n\nb) V√©rtices adjacentes:\n- A e B, A e C\n- B e D\n- C e D\n- D e E\n\nc) Graus:\n- Gr(A) = 2\n- Gr(B) = 2\n- Gr(C) = 2\n- Gr(D) = 3\n- Gr(E) = 1\n\nd) SIM, √© conexo porque existe caminho entre qualquer par de v√©rtices.'
      },
      { 
        numero: 2, 
        nivel: 'B√°sico', 
        titulo: 'Classifica√ß√£o de Grafos',
        grafo: {
          nodes: [
            { id: 'A1', label: 'A', x: 80, y: 80 },
            { id: 'B1', label: 'B', x: 180, y: 80 },
            { id: 'C1', label: 'C', x: 280, y: 80 },
            { id: 'A2', label: 'A', x: 80, y: 200 },
            { id: 'B2', label: 'B', x: 180, y: 200 },
            { id: 'A3', label: 'A', x: 350, y: 200 },
            { id: 'B3', label: 'B', x: 450, y: 200 },
            { id: 'C3', label: 'C', x: 350, y: 320 },
            { id: 'D3', label: 'D', x: 450, y: 320 },
            { id: 'A4', label: 'A', x: 550, y: 80 }
          ],
          edges: [
            { from: 'A1', to: 'B1' },
            { from: 'B1', to: 'C1' },
            { from: 'A2', to: 'B2', type: 'double' },
            { from: 'A3', to: 'B3' },
            { from: 'C3', to: 'D3' },
            { from: 'A4', to: 'A4', type: 'loop' }
          ]
        },
        enunciado: 'Classifique cada grafo quanto a:\n- Simples ou Multigrafo\n- Conexo ou Desconexo\n- Se possui pontes\n\nGrafo 1 (superior esquerdo): A-B-C linear\nGrafo 2 (meio esquerdo): Duas arestas entre A e B\nGrafo 3 (direito meio): A-B e C-D separados\nGrafo 4 (superior direito): V√©rtice A com la√ßo', 
        resposta: 'Grafo 1: SIMPLES, CONEXO, Pontes: A-B e B-C\n\nGrafo 2: MULTIGRAFO (arestas paralelas), CONEXO, Sem pontes\n\nGrafo 3: SIMPLES, DESCONEXO (A-B separado de C-D), Todas s√£o pontes\n\nGrafo 4: MULTIGRAFO (la√ßo), CONEXO, Sem ponte' 
      },
      { 
        numero: 3, 
        nivel: 'Intermedi√°rio', 
        titulo: 'Matriz de Adjac√™ncia',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 150, y: 100 },
            { id: 'B', label: 'B', x: 450, y: 100 },
            { id: 'C', label: 'C', x: 150, y: 300 },
            { id: 'D', label: 'D', x: 450, y: 300 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'A', to: 'C' },
            { from: 'B', to: 'D' },
            { from: 'C', to: 'D' }
          ]
        },
        enunciado: 'Dada a matriz de adjac√™ncia:\n\n    A B C D\nA [ 0 1 1 0 ]\nB [ 1 0 0 1 ]\nC [ 1 0 0 1 ]\nD [ 0 1 1 0 ]\n\na) O grafo est√° representado ao lado\nb) Qual o grau de cada v√©rtice?\nc) Existe algum caminho Euleriano?\nd) O grafo √© completo?', 
        resposta: 'a) O grafo forma um quadrado\n\nb) Graus: Gr(A)=2, Gr(B)=2, Gr(C)=2, Gr(D)=2\n   (soma de cada linha/coluna)\n\nc) SIM, existe caminho Euleriano.\n   TODOS os v√©rtices t√™m grau PAR.\n   Logo, existe at√© CICLO Euleriano!\n\nd) N√ÉO √© completo. Faltam arestas A-D e B-C.' 
      },
      { 
        numero: 4, 
        nivel: 'Intermedi√°rio', 
        titulo: 'Grafo Ponderado',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 100, y: 150 },
            { id: 'B', label: 'B', x: 300, y: 100 },
            { id: 'C', label: 'C', x: 500, y: 100 },
            { id: 'D', label: 'D', x: 100, y: 300 },
            { id: 'E', label: 'E', x: 500, y: 300 }
          ],
          edges: [
            { from: 'A', to: 'B', label: '5' },
            { from: 'B', to: 'C', label: '3' },
            { from: 'A', to: 'D', label: '2' },
            { from: 'C', to: 'E', label: '7' },
            { from: 'D', to: 'E', label: '4' }
          ]
        },
        enunciado: 'Dado o grafo ponderado ao lado:\n\na) Construa a matriz de adjac√™ncia ponderada\nb) Qual o caminho de A at√© E de menor custo?', 
        resposta: 'a) Matriz Ponderada:\n    A  B  C  D  E\nA [ 0  5  0  2  0 ]\nB [ 5  0  3  0  0 ]\nC [ 0  3  0  0  7 ]\nD [ 2  0  0  0  4 ]\nE [ 0  0  7  4  0 ]\n\nb) Caminhos:\n   - A‚ÜíD‚ÜíE: 2+4 = 6 ‚úì MENOR\n   - A‚ÜíB‚ÜíC‚ÜíE: 5+3+7 = 15\n\nResposta: A-D-E com custo 6' 
      },
      { 
        numero: 5, 
        nivel: 'Intermedi√°rio', 
        titulo: 'Euleriano vs Hamiltoniano',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 100, y: 100 },
            { id: 'B', label: 'B', x: 300, y: 100 },
            { id: 'C', label: 'C', x: 500, y: 100 },
            { id: 'D', label: 'D', x: 100, y: 300 },
            { id: 'E', label: 'E', x: 300, y: 300 },
            { id: 'F', label: 'F', x: 500, y: 300 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'B', to: 'C' },
            { from: 'A', to: 'D' },
            { from: 'D', to: 'E' },
            { from: 'E', to: 'F' },
            { from: 'B', to: 'E' },
            { from: 'C', to: 'F' }
          ]
        },
        enunciado: 'Para o grafo ao lado:\n\na) Existe caminho Euleriano? E ciclo Euleriano?\nb) Existe caminho Hamiltoniano? E ciclo Hamiltoniano?\nc) Justifique', 
        resposta: 'a) EULERIANO:\n   Graus: A=2, B=3, C=2, D=2, E=3, F=2\n   Caminho Euleriano: SIM (2 v√©rtices √≠mpares)\n   Ciclo: N√ÉO (nem todos pares)\n\nb) HAMILTONIANO:\n   Caminho: SIM (ex: A-D-E-F-C-B)\n   Ciclo: SIM (ex: A-B-C-F-E-D-A)\n\nc) Euleriano: verifica graus\n   Hamiltoniano: percursos de v√©rtices' 
      },
      { 
        numero: 6, 
        nivel: 'Avan√ßado', 
        titulo: 'Grafo Complementar',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 100, y: 150 },
            { id: 'B', label: 'B', x: 250, y: 100 },
            { id: 'C', label: 'C', x: 100, y: 250 },
            { id: 'D', label: 'D', x: 250, y: 200 },
            { id: 'A2', label: 'A\'', x: 400, y: 150 },
            { id: 'B2', label: 'B\'', x: 550, y: 100 },
            { id: 'C2', label: 'C\'', x: 400, y: 250 },
            { id: 'D2', label: 'D\'', x: 550, y: 200 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'A', to: 'C' },
            { from: 'A2', to: 'D2' },
            { from: 'B2', to: 'C2' },
            { from: 'B2', to: 'D2' },
            { from: 'C2', to: 'D2' }
          ]
        },
        enunciado: 'Grafo G (esquerda) tem 4 v√©rtices e arestas {A-B, A-C}\nGrafo complementar G\' (direita) √© mostrado\n\na) Qual a soma das arestas de G e G\'?\nb) O que voc√™ conclui?', 
        resposta: 'a) G: 2 arestas\n   G\': {A-D, B-C, B-D, C-D} = 4 arestas\n   Total: 6\n\nb) CONCLUS√ÉO: G + G\' = K‚ÇÑ (completo)\n   Para n=4: n(n-1)/2 = 6 ‚úì' 
      },
      { 
        numero: 7, 
        nivel: 'Avan√ßado', 
        titulo: 'Grafos Bipartidos',
        grafo: {
          nodes: [
            { id: 'A1', label: 'A', x: 80, y: 100 },
            { id: 'B1', label: 'B', x: 150, y: 150 },
            { id: 'C1', label: 'C', x: 80, y: 200 },
            { id: 'A2', label: 'A', x: 280, y: 100 },
            { id: 'B2', label: 'B', x: 400, y: 100 },
            { id: 'C2', label: 'C', x: 280, y: 200 },
            { id: 'D2', label: 'D', x: 400, y: 200 },
            { id: 'C3', label: 'C', x: 500, y: 150 },
            { id: 'P1', label: 'P1', x: 540, y: 80 },
            { id: 'P2', label: 'P2', x: 580, y: 120 },
            { id: 'P3', label: 'P3', x: 580, y: 180 },
            { id: 'P4', label: 'P4', x: 540, y: 220 }
          ],
          edges: [
            { from: 'A1', to: 'B1' },
            { from: 'B1', to: 'C1' },
            { from: 'C1', to: 'A1' },
            { from: 'A2', to: 'B2' },
            { from: 'B2', to: 'C2' },
            { from: 'C2', to: 'D2' },
            { from: 'D2', to: 'A2' },
            { from: 'C3', to: 'P1' },
            { from: 'C3', to: 'P2' },
            { from: 'C3', to: 'P3' },
            { from: 'C3', to: 'P4' }
          ]
        },
        enunciado: 'Quais grafos s√£o bipartidos?\n\nGrafo 1 (esquerda): Tri√¢ngulo\nGrafo 2 (meio): Quadrado\nGrafo 3 (direita): Estrela com 4 pontas', 
        resposta: 'Grafo 1: N√ÉO (ciclo √≠mpar de 3)\n\nGrafo 2: SIM\n   U={A,C} e V={B,D}\n\nGrafo 3: SIM\n   U={centro} e V={pontas}\n\nREGRA: Ciclos √≠mpares ‚Üí n√£o bipartido' 
      },
      { 
        numero: 8, 
        nivel: 'Avan√ßado', 
        titulo: 'Pontes de K√∂nigsberg',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 150, y: 200 },
            { id: 'B', label: 'B', x: 450, y: 150 },
            { id: 'C', label: 'C', x: 450, y: 250 },
            { id: 'D', label: 'D', x: 300, y: 200 }
          ],
          edges: [
            { from: 'A', to: 'B', type: 'double' },
            { from: 'A', to: 'C', type: 'double' },
            { from: 'B', to: 'D' },
            { from: 'C', to: 'D' },
            { from: 'B', to: 'C' }
          ]
        },
        enunciado: 'Cidade com 4 regi√µes e 7 pontes:\n- 2 pontes A-B\n- 2 pontes A-C\n- 1 ponte B-D, C-D, B-C\n\n√â poss√≠vel atravessar todas as pontes uma vez?', 
        resposta: 'Graus:\n- Gr(A)=4\n- Gr(B)=5\n- Gr(C)=5\n- Gr(D)=2\n\n3 v√©rtices √≠mpares ‚Üí N√ÉO √© poss√≠vel!\n\n(Euler, 1736)' 
      },
      { 
        numero: 9, 
        nivel: 'Avan√ßado', 
        titulo: 'Propriedades de √Årvores',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 300, y: 80 },
            { id: 'B', label: 'B', x: 200, y: 160 },
            { id: 'C', label: 'C', x: 400, y: 160 },
            { id: 'D', label: 'D', x: 150, y: 240 },
            { id: 'E', label: 'E', x: 250, y: 240 },
            { id: 'F', label: 'F', x: 350, y: 240 },
            { id: 'G', label: 'G', x: 450, y: 240 },
            { id: 'H', label: 'H', x: 120, y: 320 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'A', to: 'C' },
            { from: 'B', to: 'D' },
            { from: 'B', to: 'E' },
            { from: 'C', to: 'F' },
            { from: 'C', to: 'G' },
            { from: 'D', to: 'H' }
          ]
        },
        enunciado: '√Årvore com 8 v√©rtices:\n\na) Quantas arestas possui?\nb) Se remover 1 aresta?\nc) Se adicionar 1 aresta?\nd) Todas s√£o pontes?', 
        resposta: 'a) n-1 = 8-1 = 7 arestas\n\nb) Fica DESCONEXO\n   (arestas s√£o pontes)\n\nc) Cria CICLO\n   (√°rvore √© ac√≠clica)\n\nd) SIM, todas s√£o pontes\n\nTEOREMA: conexo + n-1 arestas + ac√≠clico' 
      },
      { 
        numero: 10, 
        nivel: 'Avan√ßado', 
        titulo: 'Isomorfismo de Grafos',
        grafo: {
          nodes: [
            { id: 'A', label: 'A', x: 80, y: 100 },
            { id: 'B', label: 'B', x: 200, y: 100 },
            { id: 'C', label: 'C', x: 80, y: 220 },
            { id: 'D', label: 'D', x: 200, y: 220 },
            { id: 'W', label: 'W', x: 300, y: 100 },
            { id: 'X', label: 'X', x: 420, y: 100 },
            { id: 'Y', label: 'Y', x: 420, y: 220 },
            { id: 'Z', label: 'Z', x: 300, y: 220 },
            { id: '1', label: '1', x: 480, y: 100 },
            { id: '2', label: '2', x: 560, y: 100 },
            { id: '3', label: '3', x: 480, y: 220 },
            { id: '4', label: '4', x: 560, y: 220 }
          ],
          edges: [
            { from: 'A', to: 'B' },
            { from: 'A', to: 'C' },
            { from: 'B', to: 'D' },
            { from: 'C', to: 'D' },
            { from: 'W', to: 'X' },
            { from: 'X', to: 'Y' },
            { from: 'Y', to: 'Z' },
            { from: 'Z', to: 'W' },
            { from: '1', to: '2' },
            { from: '1', to: '3' },
            { from: '2', to: '4' },
            { from: '3', to: '4' },
            { from: '2', to: '3' }
          ]
        },
        enunciado: 'G1 e G2 s√£o isomorfos? E G1 e G3?\n\nG1 (esquerda): 4 arestas\nG2 (meio): 4 arestas\nG3 (direita): 5 arestas', 
        resposta: 'G1 e G2: SIM\n   - Mesmos v√©rtices: 4\n   - Mesmas arestas: 4\n   - Mesmos graus: [2,2,2,2]\n   - Mapeamento: A‚ÜíW, B‚ÜíX, C‚ÜíY, D‚ÜíZ\n\nG1 e G3: N√ÉO\n   - G1: 4 arestas\n   - G3: 5 arestas\n   - Graus diferentes' 
      }
    ];

    // Estado global
    let flashcardStatus = {};
    let flashcardDuvidas = {};
    let flashcardOrdem = [];
    let exercicioTentativas = {};
    let exercicioAcertos = {};

    // Navega√ß√£o
    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      if (id === 'screen-flashcards') document.getElementById('nav-flashcards').classList.add('active');
      else if (id === 'screen-exercicios') document.getElementById('nav-exercicios').classList.add('active');
      else if (id === 'screen-estatisticas') document.getElementById('nav-estatisticas').classList.add('active');
    }

    document.getElementById('btn-iniciar-flashcards').onclick = () => { showScreen('screen-flashcards'); renderFlashcards(); };
    document.getElementById('btn-iniciar-exercicios').onclick = () => { showScreen('screen-exercicios'); renderExercicios(); };
    document.getElementById('nav-flashcards').onclick = () => { showScreen('screen-flashcards'); renderFlashcards(); };
    document.getElementById('nav-exercicios').onclick = () => { showScreen('screen-exercicios'); renderExercicios(); };
    document.getElementById('nav-estatisticas').onclick = () => { showScreen('screen-estatisticas'); renderEstatisticas(); };

    // Flashcards
    function getCategorias() {
      return [...new Set(flashcards.map(fc => fc.categoria))];
    }

    function updateFiltroCategoria() {
      const select = document.getElementById('filtro-categoria');
      select.innerHTML = '<option value="">Todas categorias</option>' + 
        getCategorias().map(cat => `<option value="${cat}">${cat}</option>`).join('');
    }
    updateFiltroCategoria();

    function filtraFlashcards() {
      let cards = [...flashcards];
      const categoria = document.getElementById('filtro-categoria').value;
      const tema = document.getElementById('filtro-tema').value.toLowerCase();
      const dificuldade = document.getElementById('filtro-dificuldade').value;
      
      if (categoria) cards = cards.filter(fc => fc.categoria === categoria);
      if (tema) cards = cards.filter(fc =>
        fc.frente.toLowerCase().includes(tema) || fc.verso.toLowerCase().includes(tema)
      );
      if (dificuldade) {
        let ids = [];
        if (dificuldade === 'B√°sico') ids = [...Array(10).keys()].map(i=>i+1);
        else if (dificuldade === 'Intermedi√°rio') ids = [...Array(9).keys()].map(i=>i+10);
        else if (dificuldade === 'Avan√ßado') ids = [...Array(8).keys()].map(i=>i+19);
        cards = cards.filter(fc => ids.includes(fc.id));
      }
      return cards;
    }

    function embaralhaArray(arr) {
      let a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    document.getElementById('btn-embaralhar-cards').onclick = () => {
      flashcardOrdem = embaralhaArray(filtraFlashcards().map(fc => fc.id));
      renderFlashcards();
    };
    document.getElementById('filtro-categoria').onchange = renderFlashcards;
    document.getElementById('filtro-dificuldade').onchange = renderFlashcards;
    document.getElementById('filtro-tema').oninput = renderFlashcards;

    let idxFlashcard = 0;
    let cardFlip = false;

    function renderFlashcards() {
      let cards = filtraFlashcards();
      let ordem = flashcardOrdem.length ? flashcardOrdem : cards.map(fc => fc.id);
      if (!ordem.length) {
        document.getElementById('flashcard-container').innerHTML = '<p style="text-align:center;color:var(--color-text-light);">Nenhum flashcard encontrado com os filtros.</p>';
        return;
      }
      if (idxFlashcard >= ordem.length) idxFlashcard = 0;
      const atualCardId = ordem[idxFlashcard];
      const fc = flashcards.find(f => f.id === atualCardId);
      
      let dom = `<div class="flashcard${cardFlip?' flipped':''}" tabindex="0" onclick="flipFlashcard()">
        <div>${cardFlip ? fc.verso.replace(/\n/g,'<br>') : fc.frente}</div>
      </div>
      <div class="card-actions">
        <button class="btn-dominei" onclick="setFlashcardStatus(${fc.id},'dominei')">‚úÖ Dominei</button>
        <button class="btn-rever" onclick="setFlashcardStatus(${fc.id},'rever')">üîÑ Rever depois</button>
        <button class="btn-dica" onclick="showDica('${fc.dica}')">üí° Dica</button>
        <button onclick="prevFlashcard()">‚¨ÖÔ∏è Anterior</button>
        <button onclick="nextFlashcard()">Pr√≥ximo ‚û°Ô∏è</button>
      </div>`;
      
      dom += `<div style="text-align:center;margin-top:1.5rem;">
        <label for="duvida-${fc.id}" style="font-size:1rem;color:var(--color-text-light);">üìù Registrar d√∫vida:</label><br>
        <input type="text" id="duvida-${fc.id}" style="width:300px;max-width:90%;margin-top:0.5rem;padding:0.75rem;border:2px solid var(--color-border);border-radius:var(--radius-md);" value="${flashcardDuvidas[fc.id]||''}" placeholder="Digite sua d√∫vida...">
        <button onclick="salvaDuvida(${fc.id})" style="padding:0.75rem 1.5rem;margin-left:0.5rem;background:var(--gradient-primary);color:white;border:none;border-radius:var(--radius-md);cursor:pointer;font-weight:600;">Salvar</button>
      </div>`;
      
      if (flashcardDuvidas[fc.id]) {
        dom += `<div class="duvida-registro">üí≠ D√∫vida registrada: ${flashcardDuvidas[fc.id]}</div>`;
      }
      
      dom += `<div class="flashcard-counter">Flashcard ${idxFlashcard+1} de ${ordem.length}</div>`;
      document.getElementById('flashcard-container').innerHTML = dom;
    }

    window.flipFlashcard = function() {
      cardFlip = !cardFlip;
      renderFlashcards();
    };
    window.nextFlashcard = function() {
      idxFlashcard = Math.min(idxFlashcard+1, (flashcardOrdem.length?flashcardOrdem.length:filtraFlashcards().length)-1);
      cardFlip = false;
      renderFlashcards();
    };
    window.prevFlashcard = function() {
      idxFlashcard = Math.max(idxFlashcard-1, 0);
      cardFlip = false;
      renderFlashcards();
    };
    window.setFlashcardStatus = function(id,status) {
      flashcardStatus[id] = status;
      renderFlashcards();
    };
    window.showDica = function(dica) {
      alert('üí° ' + dica);
    };
    window.salvaDuvida = function(id) {
      const val = document.getElementById('duvida-'+id).value;
      flashcardDuvidas[id] = val;
      renderFlashcards();
    };

    // Exerc√≠cios
    document.getElementById('filtro-nivel').onchange = renderExercicios;
    
    function renderExercicios() {
      let nivel = document.getElementById('filtro-nivel').value;
      let excs = nivel ? exercicios.filter(e=>e.nivel === nivel) : exercicios;
      let html = excs.map(e => {
        let tentativa = (exercicioTentativas[e.numero]||'');
        let diagramaHtml = '';
        if (e.grafo) {
          diagramaHtml = `<div class="exercicio-diagrama" id="diagrama-container-${e.numero}"></div>`;
        }
        return `<div class="exercicio-card">
          <div class="exercicio-titulo">${e.numero}. ${e.titulo}</div>
          ${diagramaHtml}
          <div class="exercicio-enunciado">${e.enunciado.replace(/\n/g,'<br>')}</div>
          <textarea class="exercicio-entrada" id="resp-${e.numero}" placeholder="Digite sua resposta aqui...">${tentativa}</textarea>
          <div class="exercicio-actions">
            <button class="btn-dominei" onclick="registrarResposta(${e.numero})">‚úÖ Enviar</button>
            <button class="btn-dica" onclick="exibirSolucao(${e.numero})">üëÅÔ∏è Exibir solu√ß√£o</button>
          </div>
          ${exercicioAcertos[e.numero]?'<div class="exercicio-solucao"><strong>‚úÖ Solu√ß√£o:</strong><br>'+e.resposta.replace(/\n/g,'<br>')+'</div>':''}
        </div>`;
      }).join('');
      document.getElementById('exercicios-lista').innerHTML = html;
      
      // Renderizar diagramas
      const renderer = new GraphRenderer();
      excs.forEach(e => {
        if (e.grafo) {
          const container = document.getElementById(`diagrama-container-${e.numero}`);
          if (container) {
            renderer.renderGraph(container, e.grafo);
          }
        }
      });
    }

    window.registrarResposta = function(num) {
      const val = document.getElementById('resp-'+num).value;
      exercicioTentativas[num] = val;
      if (val && val.trim().length > 0) {
        exercicioAcertos[num] = true;
        renderExercicios();
      }
    };
    window.exibirSolucao = function(num) {
      exercicioAcertos[num] = true;
      renderExercicios();
    };

    // Estat√≠sticas
    function renderEstatisticas() {
      const revisados = Object.keys(flashcardStatus).length;
      const dominei = Object.values(flashcardStatus).filter(v=>v==='dominei').length;
      const reverDepois = Object.values(flashcardStatus).filter(v=>v==='rever').length;
      const duvidas = Object.keys(flashcardDuvidas).length;
      const feitos = Object.keys(exercicioTentativas).length;
      const acertos = Object.values(exercicioAcertos).filter(x=>!!x).length;
      
      let categoriasDominei = new Set();
      for (let fid in flashcardStatus) {
        if (flashcardStatus[fid] === 'dominei') {
          let fobj = flashcards.find(x=>x.id==fid);
          if (fobj) categoriasDominei.add(fobj.categoria);
        }
      }
      
      let recomendacoes = [];
      if (reverDepois > dominei) recomendacoes.push('üìå Priorize revisar os cards marcados como "rever depois"!');
      if (duvidas > 0) recomendacoes.push('ü§î Releia os flashcards que registrou d√∫vidas.');
      if (acertos/Math.max(feitos,1) < .6 && feitos>0) recomendacoes.push('üí™ Pratique mais exerc√≠cios para aumentar a taxa de acertos.');
      
      let html = `
        <div class="estat-item"><span>üìö Flashcards revisados</span> <b>${revisados}/${flashcards.length}</b></div>
        <div class="estat-item"><span>‚úÖ Cards dominados</span> <b>${dominei}</b></div>
        <div class="estat-item"><span>üîÑ Marcar para rever</span> <b>${reverDepois}</b></div>
        <div class="estat-item"><span>üí≠ D√∫vidas registradas</span> <b>${duvidas}</b></div>
        <div class="estat-item"><span>‚úçÔ∏è Exerc√≠cios feitos</span> <b>${feitos}/${exercicios.length}</b></div>
        <div class="estat-item"><span>üéØ Taxa de acertos</span> <b>${feitos>0?(Math.round((acertos/feitos)*100)):'0'}%</b></div>
        <div class="estat-item"><span>üèÜ T√≥picos dominados</span> <b>${[...categoriasDominei].join(', ')||'Nenhum ainda'}</b></div>
      `;
      
      if (recomendacoes.length) {
        html += '<div class="recomendacao">' + recomendacoes.join('<br>') + '</div>';
      }
      
      document.getElementById('estatisticas-container').innerHTML = html;
    }

    // Inicializa√ß√£o
    window.onload = () => {
      showScreen('screen-inicio');
      updateFiltroCategoria();
    };
  </script>
</body>
</html>